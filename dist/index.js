"use strict";var y=Object.defineProperty;var w=Object.getOwnPropertyDescriptor;var v=Object.getOwnPropertyNames;var C=Object.prototype.hasOwnProperty;var b=(t,e)=>{for(var n in e)y(t,n,{get:e[n],enumerable:!0})},M=(t,e,n,a)=>{if(e&&typeof e=="object"||typeof e=="function")for(let s of v(e))!C.call(t,s)&&s!==n&&y(t,s,{get:()=>e[s],enumerable:!(a=w(e,s))||a.enumerable});return t};var U=t=>M(y({},"__esModule",{value:!0}),t);var I={};b(I,{loadChatUi:()=>E});module.exports=U(I);var m=class{listeners;port;constructor(e){this.listeners=new Map;let n=e.port1;n.onmessage=a=>{let{type:s,payload:i}=a.data;if(!this.listeners.has(s))return;this.listeners.get(s).forEach(c=>{c(i)})},this.port=n}subscribe(e,n){this.listeners.has(e)||this.listeners.set(e,[]),this.listeners.get(e).push(n)}unsubscribe(e,n){if(!this.listeners.has(e))return;let a=this.listeners.get(e),s=a.indexOf(n);s>-1&&a.splice(s,1)}dispatch(e){this.port.postMessage(e)}};var g="https://ui.chatkitty.com",E=t=>{let e=t.container?.id||"chat-ui",n=document.getElementById(e);if(!n)throw new Error(`Chat UI container not found. Please define a div with id "${e}" in your HTML page.`);if(n.hasChildNodes())throw new Error(`Chat UI container must be empty. Please remove all child elements from the div with id "${e}".`);n.style.display="relative",n.style.height=t.container?.height||"100vh",n.style.width=t.container?.width||"100%";let a=document.createElement("iframe");a.title="Chat UI",a.src=`${g}/chat?widget_id=${t.widgetId}${t.locale?`&locale=${t.locale}`:""}`,a.style.height="100%",a.style.width="100%",a.style.border="none";let s=new MessageChannel,i=new m(s);i.subscribe("live-chat:initialized",()=>{let o=[],c=t.username;c&&(i.dispatch({type:"chat:assign-configuration-option",payload:{name:"username",value:c}}),o.push("username"));let r=t.environment;r&&(i.dispatch({type:"chat:assign-configuration-option",payload:{name:"environment",value:r}}),o.push("environment"));let l=t.theme;l&&(i.dispatch({type:"chat:assign-configuration-option",payload:{name:"theme",value:l}}),o.push("theme"));let d=t.authStrategy;d&&(i.dispatch({type:"chat:assign-configuration-option",payload:{name:"authStrategy",value:d}}),o.push("authStrategy"));let p=t.profile;p&&(i.dispatch({type:"chat:assign-configuration-option",payload:{name:"profile",value:p}}),o.push("profile"));let u=t.route;u&&(i.dispatch({type:"chat:assign-configuration-option",payload:{name:"route",value:u}}),o.push("route"));let f=t.onNotificationReceived;f&&i.subscribe("chat:notification-received",h=>{f(h)}),i.dispatch({type:"chat:initialize",payload:{options:o}})}),i.subscribe("chat:mounted",o=>{let c=t.chatComponent;if(!c)return;let r=c({locale:o.locale,dispatch:h=>{i.dispatch({type:"client:dispatch",payload:{message:h}})}}),l=t.localization;l&&i.dispatch({type:"chat:strings-set",payload:{strings:l({locale:o.locale})}});let d=r.menuActions;d&&i.dispatch({type:"chat:menu-actions-set",payload:{actions:d}});let p=r.onMounted;p&&p();let u=r.channelDetailsHandler;u&&i.subscribe("chat:channel-details-selected",h=>{u(h)});let f=r.menuActionHandler;f&&i.subscribe("chat:menu-action-selected",h=>{f(h)})}),window.addEventListener("message",o=>{o.origin===g&&o.data==="chatkitty:live-chat-mounted"&&a.contentWindow?.postMessage("initialize",g,[s.port2])}),n.appendChild(a)};0&&(module.exports={loadChatUi});
