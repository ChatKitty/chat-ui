"use strict";var p=Object.defineProperty;var B=Object.getOwnPropertyDescriptor;var N=Object.getOwnPropertyNames;var _=Object.prototype.hasOwnProperty;var D=(e,t,i)=>t in e?p(e,t,{enumerable:!0,configurable:!0,writable:!0,value:i}):e[t]=i;var O=(e,t)=>{for(var i in t)p(e,i,{get:t[i],enumerable:!0})},P=(e,t,i,o)=>{if(t&&typeof t=="object"||typeof t=="function")for(let n of N(t))!_.call(e,n)&&n!==i&&p(e,n,{get:()=>t[n],enumerable:!(o=B(t,n))||o.enumerable});return e};var k=e=>P(p({},"__esModule",{value:!0}),e);var u=(e,t,i)=>(D(e,typeof t!="symbol"?t+"":t,i),i);var z={};O(z,{loadChatUi:()=>S,template:()=>R});module.exports=k(z);var f=require("lit-html");var I=require("lit-html"),$=({message:e})=>I.html`<!doctype html><html lang="en"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width,initial-scale=1"><title>Error: ${e}</title><style>body{font-family:Arial,sans-serif;background-color:#f7f9fc;color:#333;display:flex;justify-content:center;align-items:center;height:100vh;margin:0;padding:0}.error-container{max-width:600px;padding:20px;background-color:#fff;border-radius:5px;box-shadow:0 2px 10px rgba(0,0,0,.1);text-align:center}.error-header{font-size:24px;font-weight:700;margin-bottom:10px}.error-description{margin-bottom:20px}.error-hint{font-size:14px;color:#666}a{color:#007bff;text-decoration:none}a:hover{text-decoration:underline}</style></head><body><div class="error-container"><div class="error-header">Oops! ${e}</div><div class="error-description">We're sorry, but the Chat UI service is currently unavailable. Please try again later.</div><div class="error-hint">If the problem persists, please <a href="mailto:support@chatkitty.com">contact support</a>.</div></div></body></html>`;var m=class{constructor(t){u(this,"listeners");u(this,"port");this.listeners=new Map,t.addEventListener("message",i=>{let{type:o,payload:n}=i.data;if(!this.listeners.has(o))return;this.listeners.get(o).forEach(d=>{d(n)})}),this.port=t}subscribe(t,i){this.listeners.has(t)||this.listeners.set(t,[]),this.listeners.get(t).push(i)}unsubscribe(t,i){if(!this.listeners.has(t))return;let o=this.listeners.get(t),n=o.indexOf(i);n>-1&&o.splice(n,1)}dispatch(t){this.port.postMessage(t)}};var g="https://ui.chatkitty.com",K=(e,t)=>{let i=document.createElement("div");(0,f.render)(t,i),e.srcdoc=i.innerHTML},R=f.html,S=(e,t)=>{var b,C,E;let i=((b=e.container)==null?void 0:b.id)||"chat-ui",o=document.getElementById(i);if(!o)throw new Error(`Chat UI container not found. Please define a div with id "${i}" in your HTML page.`);if(o.hasChildNodes())throw new Error(`Chat UI container must be empty. Please remove all child elements from the div with id "${i}".`);o.style.display="relative",o.style.height=((C=e.container)==null?void 0:C.height)||"100vh",o.style.width=((E=e.container)==null?void 0:E.width)||"100%";let n=document.createElement("iframe");n.title="Chat UI",n.src=`${g}/chat?widget_id=${e.widgetId}${e.locale?`&locale=${e.locale}`:""}`,n.allow="autoplay; clipboard-write; fullscreen; geolocation; microphone",n.style.height="100%",n.style.width="100%",n.style.border="none";let y=new MessageChannel,d=y.port1,r=new m(d),w=!1;r.subscribe("chat-ui:connected",()=>{let a=e.onNotificationReceived;a&&r.subscribe("chat:notification-received",s=>{a(s)}),r.dispatch({type:"chat:initialize",payload:{options:{username:e.username,theme:e.theme,authentication:e.authentication,profile:e.profile,route:e.route,environment:e.$environment}}}),w=!0}),r.subscribe("chat:mounted",a=>{let s=e.chatComponent;if(!s)return;let h=s({locale:a.locale}),x=e.localization;x&&r.dispatch({type:"chat:strings-set",payload:{strings:x({locale:a.locale})}});let U=e.audio;U&&r.dispatch({type:"chat:audio-set",payload:{audio:U}});let l=h.menuActions;l==null||l.forEach(c=>{if(c.name.includes("$"))throw new Error(`Menu action name "${c.name}" cannot contain "$" character.`)}),l&&r.dispatch({type:"chat:menu-actions-set",payload:{actions:l}});let M=h.onMounted;M&&M();let L=h.onHeaderSelected;L&&r.subscribe("chat:header-selected",c=>{L(c)});let T=h.onMenuActionSelected;T&&r.subscribe("chat:menu-action-selected",c=>{T(c)})}),window.addEventListener("message",a=>{var s;a.origin===g&&a.data==="chatkitty:chat-ui-mounted"&&((s=n.contentWindow)==null||s.postMessage({type:"chat-ui:connect",payload:{version:"2.30.0",environment:"production"}},g,[y.port2]))});let v=e.errorTemplate||$;n.addEventListener("error",a=>{K(n,v({message:a.message}))}),d.start(),o.appendChild(n),setTimeout(()=>{w||K(n,v({message:"Connection timed out."}))},(t==null?void 0:t.timeout)||1e4)};0&&(module.exports={loadChatUi,template});
