"use strict";var d=Object.defineProperty;var L=Object.getOwnPropertyDescriptor;var D=Object.getOwnPropertyNames;var K=Object.prototype.hasOwnProperty;var B=(t,e,n)=>e in t?d(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n;var N=(t,e)=>{for(var n in e)d(t,n,{get:e[n],enumerable:!0})},_=(t,e,n,i)=>{if(e&&typeof e=="object"||typeof e=="function")for(let o of D(e))!K.call(t,o)&&o!==n&&d(t,o,{get:()=>e[o],enumerable:!(i=L(e,o))||i.enumerable});return t};var A=t=>_(d({},"__esModule",{value:!0}),t);var f=(t,e,n)=>(B(t,typeof e!="symbol"?e+"":e,n),n);var T={};N(T,{loadChatUi:()=>H});module.exports=A(T);var M=require("lit-html");var h=class{constructor(e){f(this,"listeners");f(this,"port");this.listeners=new Map;let n=e.port1;n.onmessage=i=>{let{type:o,payload:a}=i.data;if(!this.listeners.has(o))return;this.listeners.get(o).forEach(c=>{c(a)})},this.port=n}subscribe(e,n){this.listeners.has(e)||this.listeners.set(e,[]),this.listeners.get(e).push(n)}unsubscribe(e,n){if(!this.listeners.has(e))return;let i=this.listeners.get(e),o=i.indexOf(n);o>-1&&i.splice(o,1)}dispatch(e){this.port.postMessage(e)}};var x=require("lit-html"),E=x.html`<!doctype html><html lang="en"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width,initial-scale=1"><title>Error: ChatKitty Chat UI Unavailable</title><style>body{font-family:Arial,sans-serif;background-color:#f7f9fc;color:#333;display:flex;justify-content:center;align-items:center;height:100vh;margin:0;padding:0}.error-container{max-width:600px;padding:20px;background-color:#fff;border-radius:5px;box-shadow:0 2px 10px rgba(0,0,0,.1);text-align:center}.error-header{font-size:24px;font-weight:700;margin-bottom:10px}.error-description{margin-bottom:20px}.error-hint{font-size:14px;color:#666}a{color:#007bff;text-decoration:none}a:hover{text-decoration:underline}</style></head><body><div class="error-container"><div class="error-header">Oops! ChatKitty Chat UI Unavailable</div><div class="error-description">We're sorry, but the Chat UI service is currently unavailable. Please try again later.</div><div class="error-hint">If the problem persists, please <a href="mailto:support@chatkitty.com">contact support</a>.</div></div></body></html>`;var y="https://ui.chatkitty.com",I=t=>{let e=document.createElement("div");(0,M.render)(E,e),t.srcdoc=e.innerHTML},H=t=>{var c,u,g;let e=((c=t.container)==null?void 0:c.id)||"chat-ui",n=document.getElementById(e);if(!n)throw new Error(`Chat UI container not found. Please define a div with id "${e}" in your HTML page.`);if(n.hasChildNodes())throw new Error(`Chat UI container must be empty. Please remove all child elements from the div with id "${e}".`);n.style.display="relative",n.style.height=((u=t.container)==null?void 0:u.height)||"100vh",n.style.width=((g=t.container)==null?void 0:g.width)||"100%";let i=document.createElement("iframe");i.title="Chat UI",i.src=`${y}/chat?widget_id=${t.widgetId}${t.locale?`&locale=${t.locale}`:""}`,i.style.height="100%",i.style.width="100%",i.style.border="none";let o=new MessageChannel,a=new h(o),p=!1;a.subscribe("chat-ui:connected",()=>{let r=t.onNotificationReceived;r&&a.subscribe("chat:notification-received",s=>{r(s)}),a.dispatch({type:"chat:initialize",payload:{options:{username:t.username,theme:t.theme,authentication:t.authentication,profile:t.profile,route:t.route,environment:t.$environment}}}),p=!0}),a.subscribe("chat:mounted",r=>{let s=t.chatComponent;if(!s)return;let l=s({locale:r.locale}),v=t.localization;v&&a.dispatch({type:"chat:strings-set",payload:{strings:v({locale:r.locale})}});let w=l.menuActions;w&&a.dispatch({type:"chat:menu-actions-set",payload:{actions:w}});let b=l.onMounted;b&&b();let C=l.channelDetailsHandler;C&&a.subscribe("chat:channel-details-selected",m=>{C(m)});let U=l.menuActionHandler;U&&a.subscribe("chat:menu-action-selected",m=>{U(m)})}),window.addEventListener("message",r=>{var s;r.origin===y&&r.data==="chatkitty:chat-ui-mounted"&&((s=i.contentWindow)==null||s.postMessage({type:"chat-ui:connect",payload:{version:"2.23.2",environment:"production"}},y,[o.port2]))}),i.addEventListener("error",()=>{I(i)}),setTimeout(()=>{p||I(i)},5e3),n.appendChild(i)};0&&(module.exports={loadChatUi});
