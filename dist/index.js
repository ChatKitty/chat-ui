"use strict";var g=Object.defineProperty;var U=Object.getOwnPropertyDescriptor;var E=Object.getOwnPropertyNames;var M=Object.prototype.hasOwnProperty;var I=(e,t)=>{for(var i in t)g(e,i,{get:t[i],enumerable:!0})},K=(e,t,i,n)=>{if(t&&typeof t=="object"||typeof t=="function")for(let s of E(t))!M.call(e,s)&&s!==i&&g(e,s,{get:()=>t[s],enumerable:!(n=U(t,s))||n.enumerable});return e};var L=e=>K(g({},"__esModule",{value:!0}),e);var A={};I(A,{loadChatUi:()=>z});module.exports=L(A);var x=require("lit-html");var u=class{listeners;port;constructor(t){this.listeners=new Map;let i=t.port1;i.onmessage=n=>{let{type:s,payload:a}=n.data;if(!this.listeners.has(s))return;this.listeners.get(s).forEach(o=>{o(a)})},this.port=i}subscribe(t,i){this.listeners.has(t)||this.listeners.set(t,[]),this.listeners.get(t).push(i)}unsubscribe(t,i){if(!this.listeners.has(t))return;let n=this.listeners.get(t),s=n.indexOf(i);s>-1&&n.splice(s,1)}dispatch(t){this.port.postMessage(t)}};var w=require("lit-html"),b=w.html`<!doctype html><html lang="en"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width,initial-scale=1"><title>Error: ChatKitty Chat UI Unavailable</title><style>body{font-family:Arial,sans-serif;background-color:#f7f9fc;color:#333;display:flex;justify-content:center;align-items:center;height:100vh;margin:0;padding:0}.error-container{max-width:600px;padding:20px;background-color:#fff;border-radius:5px;box-shadow:0 2px 10px rgba(0,0,0,.1);text-align:center}.error-header{font-size:24px;font-weight:700;margin-bottom:10px}.error-description{margin-bottom:20px}.error-hint{font-size:14px;color:#666}a{color:#007bff;text-decoration:none}a:hover{text-decoration:underline}</style></head><body><div class="error-container"><div class="error-header">Oops! ChatKitty Chat UI Unavailable</div><div class="error-description">We're sorry, but the Chat UI service is currently unavailable. Please try again later.</div><div class="error-hint">If the problem persists, please <a href="mailto:support@chatkitty.com">contact support</a>.</div></div></body></html>`;var v="https://ui.chatkitty.com",C=e=>{let t=document.createElement("div");(0,x.render)(b,t),e.srcdoc=t.innerHTML},z=e=>{let t=e.container?.id||"chat-ui",i=document.getElementById(t);if(!i)throw new Error(`Chat UI container not found. Please define a div with id "${t}" in your HTML page.`);if(i.hasChildNodes())throw new Error(`Chat UI container must be empty. Please remove all child elements from the div with id "${t}".`);i.style.display="relative",i.style.height=e.container?.height||"100vh",i.style.width=e.container?.width||"100%";let n=document.createElement("iframe");n.title="Chat UI",n.src=`${v}/chat?widget_id=${e.widgetId}${e.locale?`&locale=${e.locale}`:""}`,n.style.height="100%",n.style.width="100%",n.style.border="none";let s=new MessageChannel,a=new u(s),y=!1;a.subscribe("live-chat:initialized",()=>{let o=[],l=e.username;l&&(a.dispatch({type:"chat:assign-configuration-option",payload:{name:"username",value:l}}),o.push("username"));let r=e.environment;r&&(a.dispatch({type:"chat:assign-configuration-option",payload:{name:"environment",value:r}}),o.push("environment"));let d=e.theme;d&&(a.dispatch({type:"chat:assign-configuration-option",payload:{name:"theme",value:d}}),o.push("theme"));let h=e.authStrategy;h&&(a.dispatch({type:"chat:assign-configuration-option",payload:{name:"authStrategy",value:h}}),o.push("authStrategy"));let p=e.profile;p&&(a.dispatch({type:"chat:assign-configuration-option",payload:{name:"profile",value:p}}),o.push("profile"));let m=e.route;m&&(a.dispatch({type:"chat:assign-configuration-option",payload:{name:"route",value:m}}),o.push("route"));let f=e.onNotificationReceived;f&&a.subscribe("chat:notification-received",c=>{f(c)}),a.dispatch({type:"chat:initialize",payload:{options:o}}),y=!0}),a.subscribe("chat:mounted",o=>{let l=e.chatComponent;if(!l)return;let r=l({locale:o.locale,dispatch:c=>{a.dispatch({type:"client:dispatch",payload:{message:c}})}}),d=e.localization;d&&a.dispatch({type:"chat:strings-set",payload:{strings:d({locale:o.locale})}});let h=r.menuActions;h&&a.dispatch({type:"chat:menu-actions-set",payload:{actions:h}});let p=r.onMounted;p&&p();let m=r.channelDetailsHandler;m&&a.subscribe("chat:channel-details-selected",c=>{m(c)});let f=r.menuActionHandler;f&&a.subscribe("chat:menu-action-selected",c=>{f(c)})}),window.addEventListener("message",o=>{o.origin===v&&o.data==="chatkitty:live-chat-mounted"&&n.contentWindow?.postMessage("initialize",v,[s.port2])}),n.addEventListener("error",()=>{C(n)}),setTimeout(()=>{y||C(n)},5e3),i.appendChild(n)};0&&(module.exports={loadChatUi});
