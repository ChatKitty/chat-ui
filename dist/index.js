"use strict";var h=Object.defineProperty;var L=Object.getOwnPropertyDescriptor;var K=Object.getOwnPropertyNames;var z=Object.prototype.hasOwnProperty;var A=(e,t,i)=>t in e?h(e,t,{enumerable:!0,configurable:!0,writable:!0,value:i}):e[t]=i;var D=(e,t)=>{for(var i in t)h(e,i,{get:t[i],enumerable:!0})},H=(e,t,i,n)=>{if(t&&typeof t=="object"||typeof t=="function")for(let a of K(t))!z.call(e,a)&&a!==i&&h(e,a,{get:()=>t[a],enumerable:!(n=L(t,a))||n.enumerable});return e};var T=e=>H(h({},"__esModule",{value:!0}),e);var f=(e,t,i)=>(A(e,typeof t!="symbol"?t+"":t,i),i);var B={};D(B,{loadChatUi:()=>k});module.exports=T(B);var I=require("lit-html");var p=class{constructor(t){f(this,"listeners");f(this,"port");this.listeners=new Map;let i=t.port1;i.onmessage=n=>{let{type:a,payload:o}=n.data;if(!this.listeners.has(a))return;this.listeners.get(a).forEach(l=>{l(o)})},this.port=i}subscribe(t,i){this.listeners.has(t)||this.listeners.set(t,[]),this.listeners.get(t).push(i)}unsubscribe(t,i){if(!this.listeners.has(t))return;let n=this.listeners.get(t),a=n.indexOf(i);a>-1&&n.splice(a,1)}dispatch(t){this.port.postMessage(t)}};var x=require("lit-html"),E=x.html`<!doctype html><html lang="en"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width,initial-scale=1"><title>Error: ChatKitty Chat UI Unavailable</title><style>body{font-family:Arial,sans-serif;background-color:#f7f9fc;color:#333;display:flex;justify-content:center;align-items:center;height:100vh;margin:0;padding:0}.error-container{max-width:600px;padding:20px;background-color:#fff;border-radius:5px;box-shadow:0 2px 10px rgba(0,0,0,.1);text-align:center}.error-header{font-size:24px;font-weight:700;margin-bottom:10px}.error-description{margin-bottom:20px}.error-hint{font-size:14px;color:#666}a{color:#007bff;text-decoration:none}a:hover{text-decoration:underline}</style></head><body><div class="error-container"><div class="error-header">Oops! ChatKitty Chat UI Unavailable</div><div class="error-description">We're sorry, but the Chat UI service is currently unavailable. Please try again later.</div><div class="error-hint">If the problem persists, please <a href="mailto:support@chatkitty.com">contact support</a>.</div></div></body></html>`;var y="https://ui.chatkitty.com",M=e=>{let t=document.createElement("div");(0,I.render)(E,t),e.srcdoc=t.innerHTML},k=e=>{var l,u,g;let t=((l=e.container)==null?void 0:l.id)||"chat-ui",i=document.getElementById(t);if(!i)throw new Error(`Chat UI container not found. Please define a div with id "${t}" in your HTML page.`);if(i.hasChildNodes())throw new Error(`Chat UI container must be empty. Please remove all child elements from the div with id "${t}".`);i.style.display="relative",i.style.height=((u=e.container)==null?void 0:u.height)||"100vh",i.style.width=((g=e.container)==null?void 0:g.width)||"100%";let n=document.createElement("iframe");n.title="Chat UI",n.src=`${y}/chat?widget_id=${e.widgetId}${e.locale?`&locale=${e.locale}`:""}`,n.style.height="100%",n.style.width="100%",n.style.border="none";let a=new MessageChannel,o=new p(a),m=!1;o.subscribe("chat-ui:connected",()=>{let r=e.onNotificationReceived;r&&o.subscribe("chat:notification-received",s=>{r(s)}),o.dispatch({type:"chat:initialize",payload:{options:{username:e.username,environment:e.environment,theme:e.theme,authStrategy:e.authStrategy,profile:e.profile,route:e.route}}}),m=!0}),o.subscribe("chat:mounted",r=>{let s=e.chatComponent;if(!s)return;let d=s({locale:r.locale,dispatch:c=>{o.dispatch({type:"client:dispatch",payload:{message:c}})}}),v=e.localization;v&&o.dispatch({type:"chat:strings-set",payload:{strings:v({locale:r.locale})}});let w=d.menuActions;w&&o.dispatch({type:"chat:menu-actions-set",payload:{actions:w}});let b=d.onMounted;b&&b();let C=d.channelDetailsHandler;C&&o.subscribe("chat:channel-details-selected",c=>{C(c)});let U=d.menuActionHandler;U&&o.subscribe("chat:menu-action-selected",c=>{U(c)})}),window.addEventListener("message",r=>{var s;r.origin===y&&r.data==="chatkitty:chat-ui-mounted"&&((s=n.contentWindow)==null||s.postMessage("initialize",y,[a.port2]))}),n.addEventListener("error",()=>{M(n)}),setTimeout(()=>{m||M(n)},5e3),i.appendChild(n)};0&&(module.exports={loadChatUi});
