"use strict";var h=Object.defineProperty;var K=Object.getOwnPropertyDescriptor;var B=Object.getOwnPropertyNames;var N=Object.prototype.hasOwnProperty;var _=(e,t,n)=>t in e?h(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n;var D=(e,t)=>{for(var n in t)h(e,n,{get:t[n],enumerable:!0})},P=(e,t,n,o)=>{if(t&&typeof t=="object"||typeof t=="function")for(let i of B(t))!N.call(e,i)&&i!==n&&h(e,i,{get:()=>t[i],enumerable:!(o=K(t,i))||o.enumerable});return e};var k=e=>P(h({},"__esModule",{value:!0}),e);var y=(e,t,n)=>(_(e,typeof t!="symbol"?t+"":t,n),n);var z={};D(z,{loadChatUi:()=>S,template:()=>R});module.exports=k(z);var m=require("lit-html");var I=require("lit-html"),L=({message:e})=>I.html`<!doctype html><html lang="en"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width,initial-scale=1"><title>Error: ${e}</title><style>body{font-family:Arial,sans-serif;background-color:#f7f9fc;color:#333;display:flex;justify-content:center;align-items:center;height:100vh;margin:0;padding:0}.error-container{max-width:600px;padding:20px;background-color:#fff;border-radius:5px;box-shadow:0 2px 10px rgba(0,0,0,.1);text-align:center}.error-header{font-size:24px;font-weight:700;margin-bottom:10px}.error-description{margin-bottom:20px}.error-hint{font-size:14px;color:#666}a{color:#007bff;text-decoration:none}a:hover{text-decoration:underline}</style></head><body><div class="error-container"><div class="error-header">Oops! ${e}</div><div class="error-description">We're sorry, but the Chat UI service is currently unavailable. Please try again later.</div><div class="error-hint">If the problem persists, please <a href="mailto:support@chatkitty.com">contact support</a>.</div></div></body></html>`;var p=class{constructor(t){y(this,"listeners");y(this,"port");this.listeners=new Map,t.addEventListener("message",n=>{let{type:o,payload:i}=n.data;if(!this.listeners.has(o))return;this.listeners.get(o).forEach(a=>{a(i)})}),this.port=t}subscribe(t,n){this.listeners.has(t)||this.listeners.set(t,[]),this.listeners.get(t).push(n)}unsubscribe(t,n){if(!this.listeners.has(t))return;let o=this.listeners.get(t),i=o.indexOf(n);i>-1&&o.splice(i,1)}dispatch(t){this.port.postMessage(t)}};var u="https://ui.chatkitty.com",$=(e,t)=>{let n=document.createElement("div");(0,m.render)(t,n),e.srcdoc=n.innerHTML},R=m.html,S=e=>{var v,b,C;let t=((v=e.container)==null?void 0:v.id)||"chat-ui",n=document.getElementById(t);if(!n)throw new Error(`Chat UI container not found. Please define a div with id "${t}" in your HTML page.`);if(n.hasChildNodes())throw new Error(`Chat UI container must be empty. Please remove all child elements from the div with id "${t}".`);n.style.display="relative",n.style.height=((b=e.container)==null?void 0:b.height)||"100vh",n.style.width=((C=e.container)==null?void 0:C.width)||"100%";let o=document.createElement("iframe");o.title="Chat UI",o.src=`${u}/chat?widget_id=${e.widgetId}${e.locale?`&locale=${e.locale}`:""}`,o.allow="autoplay; clipboard-write; fullscreen; geolocation; microphone",o.style.height="100%",o.style.width="100%",o.style.border="none";let i=new MessageChannel,f=i.port1,a=new p(f),g=!1;a.subscribe("chat-ui:connected",()=>{let r=e.onNotificationReceived;r&&a.subscribe("chat:notification-received",s=>{r(s)}),a.dispatch({type:"chat:initialize",payload:{options:{username:e.username,theme:e.theme,authentication:e.authentication,profile:e.profile,route:e.route,environment:e.$environment}}}),g=!0}),a.subscribe("chat:mounted",r=>{let s=e.chatComponent;if(!s)return;let d=s({locale:r.locale}),E=e.localization;E&&a.dispatch({type:"chat:strings-set",payload:{strings:E({locale:r.locale})}});let x=e.audio;x&&a.dispatch({type:"chat:audio-set",payload:{audio:x}});let l=d.menuActions;l==null||l.forEach(c=>{if(c.name.includes("$"))throw new Error(`Menu action name "${c.name}" cannot contain "$" character.`)}),l&&a.dispatch({type:"chat:menu-actions-set",payload:{actions:l}});let U=d.onMounted;U&&U();let M=d.onHeaderSelected;M&&a.subscribe("chat:header-selected",c=>{M(c)});let T=d.onMenuActionSelected;T&&a.subscribe("chat:menu-action-selected",c=>{T(c)})}),window.addEventListener("message",r=>{var s;r.origin===u&&r.data==="chatkitty:chat-ui-mounted"&&((s=o.contentWindow)==null||s.postMessage({type:"chat-ui:connect",payload:{version:"2.29.1",environment:"production"}},u,[i.port2]))});let w=e.errorTemplate||L;o.addEventListener("error",r=>{$(o,w({message:r.message}))}),f.start(),n.appendChild(o),setTimeout(()=>{g||$(o,w({message:"Connection timed out."}))},1e4)};0&&(module.exports={loadChatUi,template});
