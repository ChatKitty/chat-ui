"use strict";var m=Object.defineProperty;var v=Object.getOwnPropertyDescriptor;var w=Object.getOwnPropertyNames;var C=Object.prototype.hasOwnProperty;var $=(t,e)=>{for(var n in e)m(t,n,{get:e[n],enumerable:!0})},N=(t,e,n,i)=>{if(e&&typeof e=="object"||typeof e=="function")for(let o of w(e))!C.call(t,o)&&o!==n&&m(t,o,{get:()=>e[o],enumerable:!(i=v(e,o))||i.enumerable});return t};var A=t=>N(m({},"__esModule",{value:!0}),t);var E={};$(E,{loadChatUi:()=>U});module.exports=A(E);var y=class{listeners;port;constructor(e){this.listeners=new Map;let n=e.port1;n.onmessage=i=>{let{type:o,payload:s}=i.data;if(!this.listeners.has(o))return;this.listeners.get(o).forEach(d=>{d(s)})},this.port=n}subscribe(e,n){this.listeners.has(e)||this.listeners.set(e,[]),this.listeners.get(e).push(n)}unsubscribe(e,n){if(!this.listeners.has(e))return;let i=this.listeners.get(e),o=i.indexOf(n);o>-1&&i.splice(o,1)}dispatch(e){this.port.postMessage(e)}};function a(t,e){if(!e.length)return t;if(!t)return;let[n,...i]=e;if(typeof n=="number"&&M(t))return a(t[n],i);if((typeof n=="number"||typeof n=="string")&&x(t))return a(t[n],i)}function M(t){return Array.isArray(t)}function x(t){return typeof t=="object"&&t!==null}var g="https://ui.chatkitty.com",U=t=>{let e=a(t,["container","id"])||"chat-ui",n=document.getElementById(e);if(!n)throw new Error(`Chat UI container not found. Please define a div with id "${e}" in your HTML page.`);if(n.firstChild)throw new Error(`Chat UI container must be empty. Please remove all child elements from the div with id "${e}".`);n.style.display="relative",n.style.height=a(t,["container","height"])||"100vh",n.style.width=a(t,["container","width"])||"100%";let i=document.createElement("iframe");i.title="Chat UI",i.src=`${g}/chat?widget_id=${t.widgetId}${t.locale?`&locale=${t.locale}`:""}`,i.style.height="100%",i.style.width="100%",i.style.border="none";let o=new MessageChannel,s=new y(o);s.subscribe("live-chat:initialized",()=>{let r=[],d=a(t,["username"]);d&&(s.dispatch({type:"chat:assign-configuration-option",payload:{name:"username",value:d}}),r.push("username"));let h=a(t,["environment"]);h&&(s.dispatch({type:"chat:assign-configuration-option",payload:{name:"environment",value:h}}),r.push("environment"));let p=a(t,["theme"]);p&&(s.dispatch({type:"chat:assign-configuration-option",payload:{name:"theme",value:p}}),r.push("theme"));let l=a(t,["authStrategy"]);l&&(s.dispatch({type:"chat:assign-configuration-option",payload:{name:"authStrategy",value:l}}),r.push("authStrategy"));let u=a(t,["profile"]);u&&(s.dispatch({type:"chat:assign-configuration-option",payload:{name:"profile",value:u}}),r.push("profile"));let f=a(t,["route"]);f&&(s.dispatch({type:"chat:assign-configuration-option",payload:{name:"route",value:f}}),r.push("route"));let c=a(t,["onNotificationReceived"]);c&&s.subscribe("chat:notification-received",b=>{c(b)}),s.dispatch({type:"chat:initialize",payload:{options:r}})}),s.subscribe("chat:mounted",r=>{let d=a(t,["chatComponent"]);if(!d)return;let h=d({...r,dispatch:c=>{s.dispatch({type:"client:dispatch",payload:{message:c}})}}),p=a(h,["menuActions"]);p&&s.dispatch({type:"chat:menu-actions-set",payload:{actions:p}});let l=a(h,["onMounted"]);l&&l();let u=a(h,["channelDetailsHandler"]);u&&s.subscribe("chat:channel-details-selected",c=>{u(c)});let f=a(h,["menuActionHandler"]);f&&s.subscribe("chat:menu-action-selected",c=>{f(c)})}),window.addEventListener("message",r=>{r.origin===g&&r.data==="chatkitty:live-chat-mounted"&&i.contentWindow?.postMessage("initialize",g,[o.port2])}),n.appendChild(i)};0&&(module.exports={loadChatUi});
