"use strict";var p=Object.defineProperty;var _=Object.getOwnPropertyDescriptor;var A=Object.getOwnPropertyNames;var D=Object.prototype.hasOwnProperty;var O=(t,e,n)=>e in t?p(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n;var P=(t,e)=>{for(var n in e)p(t,n,{get:e[n],enumerable:!0})},k=(t,e,n,r)=>{if(e&&typeof e=="object"||typeof e=="function")for(let a of A(e))!D.call(t,a)&&a!==n&&p(t,a,{get:()=>e[a],enumerable:!(r=_(e,a))||r.enumerable});return t};var N=t=>k(p({},"__esModule",{value:!0}),t);var g=(t,e,n)=>(O(t,typeof e!="symbol"?e+"":e,n),n);var H={};P(H,{loadChatUi:()=>F,template:()=>z});module.exports=N(H);var u=require("lit-html");var B=require("lit-html"),K=({message:t})=>B.html`<!doctype html><html lang="en"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width,initial-scale=1"><title>Error: ${t}</title><style>body{font-family:Arial,sans-serif;background-color:#f7f9fc;color:#333;display:flex;justify-content:center;align-items:center;height:100vh;margin:0;padding:0}.error-container{max-width:600px;padding:20px;background-color:#fff;border-radius:5px;box-shadow:0 2px 10px rgba(0,0,0,.1);text-align:center}.error-header{font-size:24px;font-weight:700;margin-bottom:10px}.error-description{margin-bottom:20px}.error-hint{font-size:14px;color:#666}a{color:#007bff;text-decoration:none}a:hover{text-decoration:underline}</style></head><body><div class="error-container"><div class="error-header">Oops! ${t}</div><div class="error-description">We're sorry, but the Chat UI service is currently unavailable. Please try again later.</div><div class="error-hint">If the problem persists, please <a href="mailto:support@chatkitty.com">contact support</a>.</div></div></body></html>`;var f=class{constructor(e){g(this,"listeners");g(this,"port");this.listeners=new Map,e.addEventListener("message",n=>{let{type:r,payload:a}=n.data;if(!this.listeners.has(r))return;this.listeners.get(r).forEach(d=>{d(a)})}),this.port=e}subscribe(e,n){this.listeners.has(e)||this.listeners.set(e,[]),this.listeners.get(e).push(n)}unsubscribe(e,n){if(!this.listeners.has(e))return;let r=this.listeners.get(e),a=r.indexOf(n);a>-1&&r.splice(a,1)}dispatch(e){this.port.postMessage(e)}};var w="https://ui.chatkitty.com",S=(t,e)=>{let n=document.createElement("div");(0,u.render)(e,n),t.srcdoc=n.innerHTML},z=u.html,F=(t,e)=>{var C,E,x,U;let n=((C=t.container)==null?void 0:C.id)||"chat-ui",r=document.getElementById(n);if(!r)throw new Error(`Chat UI container not found. Please define a div with id "${n}" in your HTML page.`);if(r.hasChildNodes())throw new Error(`Chat UI container must be empty. Please remove all child elements from the div with id "${n}".`);r.style.display="relative",r.style.height=((E=t.container)==null?void 0:E.height)||"100vh",r.style.width=((x=t.container)==null?void 0:x.width)||"100%";let a=document.createElement("iframe");a.title="Chat UI",a.src=`${w}/chat?widget_id=${t.widgetId}${t.locale?`&locale=${t.locale}`:""}`,a.allow="autoplay; clipboard-write; fullscreen; geolocation; microphone",a.style.height="100%",a.style.width="100%",a.style.border="none";let y=new MessageChannel,d=y.port1,i=new f(d),v=!1;i.subscribe("chat-ui:connected",()=>{var o;i.dispatch({type:"chat:initialize",payload:{options:{username:t.username||((o=e==null?void 0:e.connection)==null?void 0:o.username),theme:t.theme,authentication:t.authentication,profile:t.profile,route:t.route,environment:e==null?void 0:e.$environment}}}),v=!0}),i.subscribe("chat:mounted",o=>{var $;let h=($=t.components)==null?void 0:$.chat;if(!h)return;let s=h({locale:o.locale}),c=t.localization;c&&i.dispatch({type:"chat:strings-set",payload:{strings:c({locale:o.locale})}});let M=t.audio;M&&i.dispatch({type:"chat:audio-set",payload:{audio:M}});let m=s.menuActions;m==null||m.forEach(l=>{if(l.name.includes("$"))throw new Error(`Menu action name "${l.name}" cannot contain "$" character.`)}),m&&i.dispatch({type:"chat:menu-actions-set",payload:{actions:m}});let I=s.onMounted;I&&I();let L=s.onHeaderSelected;L&&i.subscribe("chat:header-selected",l=>{L(l)});let T=s.onMenuActionSelected;T&&i.subscribe("chat:menu-action-selected",l=>{T(l)})}),window.addEventListener("message",o=>{var s;if(o.origin!==w||o.data!=="chatkitty:chat-ui-mounted")return;let h="standalone";if(e!=null&&e.connection){let c=e.connection;if(t.username&&t.username!==c.username)throw new Error(`Chat UI username "${t.username}" does not match connection username "${c.username}".`);c.attach(d),h="shared"}(s=a.contentWindow)==null||s.postMessage({type:"chat-ui:connect",payload:{version:"2.30.0",environment:"production",connection:h}},w,[y.port2])});let b=((U=t.templates)==null?void 0:U.error)||K;a.addEventListener("error",o=>{S(a,b({message:o.message}))}),d.start(),r.appendChild(a),setTimeout(()=>{v||S(a,b({message:"Connection timed out."}))},(e==null?void 0:e.timeout)||1e4)};0&&(module.exports={loadChatUi,template});
