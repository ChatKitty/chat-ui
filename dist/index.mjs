var E=Object.defineProperty;var I=(t,e,n)=>e in t?E(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n;var m=(t,e,n)=>(I(t,typeof e!="symbol"?e+"":e,n),n);import{render as L}from"lit-html";var d=class{constructor(e){m(this,"listeners");m(this,"port");this.listeners=new Map;let n=e.port1;n.onmessage=i=>{let{type:a,payload:o}=i.data;if(!this.listeners.has(a))return;this.listeners.get(a).forEach(c=>{c(o)})},this.port=n}subscribe(e,n){this.listeners.has(e)||this.listeners.set(e,[]),this.listeners.get(e).push(n)}unsubscribe(e,n){if(!this.listeners.has(e))return;let i=this.listeners.get(e),a=i.indexOf(n);a>-1&&i.splice(a,1)}dispatch(e){this.port.postMessage(e)}};import{html as M}from"lit-html";var U=M`<!doctype html><html lang="en"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width,initial-scale=1"><title>Error: ChatKitty Chat UI Unavailable</title><style>body{font-family:Arial,sans-serif;background-color:#f7f9fc;color:#333;display:flex;justify-content:center;align-items:center;height:100vh;margin:0;padding:0}.error-container{max-width:600px;padding:20px;background-color:#fff;border-radius:5px;box-shadow:0 2px 10px rgba(0,0,0,.1);text-align:center}.error-header{font-size:24px;font-weight:700;margin-bottom:10px}.error-description{margin-bottom:20px}.error-hint{font-size:14px;color:#666}a{color:#007bff;text-decoration:none}a:hover{text-decoration:underline}</style></head><body><div class="error-container"><div class="error-header">Oops! ChatKitty Chat UI Unavailable</div><div class="error-description">We're sorry, but the Chat UI service is currently unavailable. Please try again later.</div><div class="error-hint">If the problem persists, please <a href="mailto:support@chatkitty.com">contact support</a>.</div></div></body></html>`;var f="https://ui.chatkitty.com",x=t=>{let e=document.createElement("div");L(U,e),t.srcdoc=e.innerHTML},P=t=>{var c,y,u;let e=((c=t.container)==null?void 0:c.id)||"chat-ui",n=document.getElementById(e);if(!n)throw new Error(`Chat UI container not found. Please define a div with id "${e}" in your HTML page.`);if(n.hasChildNodes())throw new Error(`Chat UI container must be empty. Please remove all child elements from the div with id "${e}".`);n.style.display="relative",n.style.height=((y=t.container)==null?void 0:y.height)||"100vh",n.style.width=((u=t.container)==null?void 0:u.width)||"100%";let i=document.createElement("iframe");i.title="Chat UI",i.src=`${f}/chat?widget_id=${t.widgetId}${t.locale?`&locale=${t.locale}`:""}`,i.style.height="100%",i.style.width="100%",i.style.border="none";let a=new MessageChannel,o=new d(a),h=!1;o.subscribe("chat-ui:connected",()=>{let r=t.onNotificationReceived;r&&o.subscribe("chat:notification-received",s=>{r(s)}),o.dispatch({type:"chat:initialize",payload:{options:{username:t.username,theme:t.theme,authentication:t.authentication,profile:t.profile,route:t.route,environment:t.$environment}}}),h=!0}),o.subscribe("chat:mounted",r=>{let s=t.chatComponent;if(!s)return;let l=s({locale:r.locale}),g=t.localization;g&&o.dispatch({type:"chat:strings-set",payload:{strings:g({locale:r.locale})}});let v=l.menuActions;v&&o.dispatch({type:"chat:menu-actions-set",payload:{actions:v}});let w=l.onMounted;w&&w();let b=l.channelDetailsHandler;b&&o.subscribe("chat:channel-details-selected",p=>{b(p)});let C=l.menuActionHandler;C&&o.subscribe("chat:menu-action-selected",p=>{C(p)})}),window.addEventListener("message",r=>{var s;r.origin===f&&r.data==="chatkitty:chat-ui-mounted"&&((s=i.contentWindow)==null||s.postMessage({type:"chat-ui:connect",payload:{version:"2.23.2",environment:"production"}},f,[a.port2]))}),i.addEventListener("error",()=>{x(i)}),setTimeout(()=>{h||x(i)},5e3),n.appendChild(i)};export{P as loadChatUi};
